## 1.包格式
`RFC9000` 10.3中定义无状态重置包格式如下：
```C
Stateless Reset {
 Fixed Bits (2) = 1,
 Unpredictable Bits (38..),
 Stateless Reset Token (128),
}
```

## 2. 包说明
`RFC9000`中关于无状态重置包的说明如下：
- 无状态重置包为短包，即包头为短包头
- 无状态重置包不能和其他数据包在同一个`UDP`数据报中发送
- 包中至少包含`5`字节的随机值，无状态重置`Token`的长度固定为`16`字节
- 如果收到的包的长度`Length`小于等于`43`字节，则无状态重置包的长度为`Length - 1`

## 3.字节长度说明
以上涉及到的字节长度主要为了无状态重置包的长度和短包的长度比较相似，避免攻击者通过包的长度猜测包的类型。
### 5字节
短包包头中去掉`目的连接ID`和包载荷之外的长度是`5`字节。

短包的包头格式如下：
```C
1-RTT Packet {
 Header Form (1) = 0,
 Fixed Bit (1) = 1,
 Spin Bit (1),
 Reserved Bits (2),
 Key Phase (1),
 Packet Number Length (2),
 Destination Connection ID (0..160),
 Packet Number (8..32),
 Packet Payload (8..),
}
```
### 16字节
短包内容在加密之后，会增加一个`16`字节长度的认证`Tag`，使用该`Tag`验证数据包的完整性和可信度。

无状态重置包中的Token也使用16字节，使得包的自己长度比较可信。
### 43字节
5字节加上16字节总共是21字节，21字节长度仍然和短包长度有一定的出入。这个出入主要在`目的连接ID`的长度上。

`RFC9000` 7.2节规定了`目的连接ID`的最短长度：
![最短长度](https://hellobug0.github.io/quic/png/DCID-8.png)

`RFC9000` 17.2节规定了`目的连接ID`的最长长度：
![最长长度](https://hellobug0.github.io/quic/png/DCID-20.png)

`RFC9000`中规定无状态重置帧的长度需要为22+21个字节长度，新增的22个字节为了模拟20个字节的连接ID进行混淆。

